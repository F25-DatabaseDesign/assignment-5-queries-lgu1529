-- 1) How many containers of antibiotics are currently available?

SELECT item.quantityOnHand 
FROM item 
WHERE item.itemDescription LIKE '%antibiotics%';

-- 2) Which volunteer(s), if any, have phone numbers that do not start with the number 2 and 
-- whose last name is not Jones. Query should retrieve names rather than ids.

SELECT volunteer.volunteerName 
FROM volunteer 
WHERE volunteer.volunteerTelephone NOT LIKE '%2' 
AND volunteer.volunteerName NOT LIKE '%Jones';

-- 3) Which volunteer(s) are working on transporting tasks? Query should retrieve names
-- rather than ids.
SELECT volunteer.volunteerName 
FROM volunteer 
JOIN volunteer.volunteerId, assignment.volunteerId
IN assignment.taskCode = task.taskCode
WHERE taskDescription LIKE '%Transport%';

-- 4) Which task(s) have yet to be assigned to any volunteers (provide task descriptions, not
-- the codes?
SELECT t.taskDescription
FROM task t
LEFT JOIN assignment a 
ON t.taskCode = a.taskCode
WHERE a.taskCode IS NULL;

-- 5) Which type(s) of package contain some kind of bottle?
SELECT DISTINCT pt.packageTypeName
FROM package_type pt
JOIN package p 
ON pt.packageTypeId = p.packageTypeId
JOIN package_contents pc
ON p.packageId = pc.packageId
JOIN item i  
ON i.itemId = pc.itemId
WHERE i.itemDescription LIKE '%bottle%';


-- 6) Which items, if any, are not in any packages? Answer should be item descriptions.
SELECT i.itemDescription
FROM item i 
LEFT JOIN package_contents pc
ON i.itemId = pc.itemId
WHERE pc.itemId IS NULL;

-- 7) Which task(s) are assigned to volunteer(s) that live in New Jersey (NJ)? Answer should
-- have the task description and not the task ids.
SELECT DISTINCT t.taskDescription
FROM task t 
JOIN assignment a
ON t.taskCode = a.taskCode
JOIN volunteer v
ON a.volunteerId = v.volunteerId
WHERE v.volunteerAddress LIKE '%NJ%';

-- 8) Which volunteers began their assignments in the first half of 2021? Answer should have
-- the volunteer names and not their ids.
SELECT v.volunteerName 
FROM volunteer v
JOIN assignment a
ON v.volunteerId = a.volunteerId
WHERE a.startDateTime BETWEEN '2021-01-01' AND '2021-06-30';

-- 9) Which volunteers have been assigned to tasks that include packing spam? Answer
-- should have the volunteer names and not their ids.
SELECT DISTINCT v.volunteerName
FROM volunteer v
JOIN assignment a
ON v.volunteerId = a.volunteerId
JOIN task t
ON a.taskCode = t.taskCode
JOIN package p 
ON t.taskCode = p.taskCode
JOIN package_contents pc
ON p.packageId = pc.packageId
WHERE pc.itemId = 1;

-- 10) Which item(s) (if any) have a total value of exactly $100 in one package? Answer should
-- be item descriptions.
SELECT i.itemDescription
FROM item i 
JOIN package_contents pc
ON i.itemId = pc.itemId
WHERE pc.itemQuantity * i.itemValue = 100;

-- 11) How many volunteers are assigned to tasks with each different status? The answer
-- should show each different status and the number of volunteers sorted from highest to
-- lowest)
SELECT ts.taskStatusName, COUNT(DISTINCT a.volunteerId) AS numVolunteers
FROM task t
JOIN task_status ts
ON t.taskStatusId = ts.taskStatusId
JOIN assignment a
ON t.taskCode = a.taskCode
GROUP BY ts.taskStatusName
ORDER BY numVolunteers DESC;

-- 12) Which task creates the heaviest set of packages and what is the weight? Show both the
-- taskCode and the weight (You should be able to do this without using any sub-queries).
SELECT t.taskCode, SUM(p.packageWeight) AS totalWeight
FROM task t
JOIN package p
ON t.taskCode = p.taskCode
GROUP BY t.taskCode
ORDER BY totalWeight DESC
LIMIT 1;

-- 13) How many tasks are there that do not have a type of “packing”?
SELECT COUNT(*) AS nonPackingTasks
FROM task t
JOIN task_type tt
ON t.taskTypeId = tt.taskTypeId
WHERE tt.taskTypeName NOT LIKE '%packing%';

-- 14) Of those items that have been packed, which item (or items) were touched by fewer
-- than 3 volunteers? Answer should be item descriptions.
SELECT i.itemDescription, COUNT(DISTINCT v.volunteerId) AS numVolunteers
FROM item i
JOIN package_contents pc
ON i.itemId = pc.itemId
JOIN package p
ON pc.packageId = p.packageId
JOIN task t
ON p.taskCode = t.taskCode
JOIN assignment a
ON t.taskCode = a.taskCode
JOIN volunteer v
ON a.volunteerId = v.volunteerId
GROUP BY i.itemDescription
HAVING COUNT(DISTINCT v.volunteerId) < 3;

-- 15) Which packages have a total value of more than 100? Show the packageIds and their
-- value sorted from lowest to highest.
SELECT p.packageId, SUM(i.itemValue * pc.itemQuantity) AS totalVal
FROM package p
JOIN package_contents pc
ON p.packageId = pc.packageId
JOIN item i
ON pc.itemId = i.itemId
GROUP BY p.packageId
HAVING SUM(i.itemValue * pc.itemQuantity) > 100
ORDER BY totalVal ASC;

